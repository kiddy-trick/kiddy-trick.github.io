var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(g){var d=0;return function(){return d<g.length?{done:!1,value:g[d++]}:{done:!0}}};$jscomp.arrayIterator=function(g){return{next:$jscomp.arrayIteratorImpl(g)}};$jscomp.makeIterator=function(g){var d="undefined"!=typeof Symbol&&Symbol.iterator&&g[Symbol.iterator];return d?d.call(g):$jscomp.arrayIterator(g)};
var cartApi=function(){function g(){localStorage.setItem("shoppingCart",JSON.stringify(d))}var d=[],p=function(d,b,a,f,g){this.id=d;this.title=b;this.price=a;this.url=f;this.count=g};null!=localStorage.getItem("shoppingCart")&&(d=JSON.parse(localStorage.getItem("shoppingCart")));return{addNewItemToCart:function(e,b,a,f,l){for(var n=$jscomp.makeIterator(d),k=n.next();!k.done;k=n.next())if(k=k.value,k.id===e)return k.count+=l,g(),k.count;e=new p(e,b,a,f,l);d.push(e);g();return e.count},addItemToCart:function(e){for(var b=
$jscomp.makeIterator(d),a=b.next();!a.done;a=b.next())if(a=a.value,a.id==e)return a.count++,g(),a.count},setCountForItem:function(e,b){for(var a=$jscomp.makeIterator(d),f=a.next();!f.done;f=a.next())if(f=f.value,f.id===e)return f.count=b,g(),f.count},removeItemFromCart:function(e){for(var b=$jscomp.makeIterator(d),a=b.next();!a.done;a=b.next())if(a=a.value,a.id===e)return a.count--,0===a.count&&d.splice(d.indexOf(a),1),g(),a.count},removeItemFromCartAll:function(e){for(var b=$jscomp.makeIterator(d),
a=b.next();!a.done;a=b.next())if(a=a.value,a.id===e){d.splice(d.indexOf(a),1);g();break}},clearCart:function(){d=[];g()},totalCount:function(){for(var e=0,b=$jscomp.makeIterator(d),a=b.next();!a.done;a=b.next())e+=a.value.count;return e},totalCart:function(){for(var e=0,b=$jscomp.makeIterator(d),a=b.next();!a.done;a=b.next())a=a.value,e+=a.price*a.count;return Number(e.toFixed(2))},listCart:function(){return d},cartToQuerry:function(){for(var e="",b=$jscomp.makeIterator(d),a=b.next();!a.done;a=b.next())item=
a.value,e+="&product="+encodeURIComponent(item.title)+"&price="+encodeURIComponent(item.price)+"&count="+encodeURIComponent(item.count)+"&url="+encodeURIComponent(item.url);return e}}}();
(function(){function g(c){return c.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function d(){var c=cartApi.listCart(),v=document.querySelector(".show-cart");v.innerHTML="";var a=document.createDocumentFragment();c=$jscomp.makeIterator(c);for(var b=c.next();!b.done;b=c.next()){b=b.value;var d=document.createElement("div");d.id=b.id;d.classList.add("cart-item");var e=document.createElement("a");e.href=b.url;d.appendChild(e);var h=document.createElement("img");h.classList.add("image");h.src="/images/catalog"+
b.url+"-01_400w.jpg";e.appendChild(h);e=document.createElement("div");e.classList.add("cart-text");d.appendChild(e);h=document.createElement("a");h.href=b.url;h.innerText=b.title;e.appendChild(h);h=document.createElement("h3");h.innerText=g(b.price)+" \u20bd";e.appendChild(h);var f=document.createElement("div");e.appendChild(f);h=document.createElement("a");h.classList.add("minus-item","button");h.setAttribute("data",b.id);h.innerText="-";f.appendChild(h);h=document.createElement("span");h.setAttribute("data",
b.id);h.innerText=b.count;f.appendChild(h);h=document.createElement("a");h.classList.add("plus-item","button");h.setAttribute("data",b.id);h.innerText="+";f.appendChild(h);a.appendChild(d)}v.appendChild(a)}function p(){var c=cartApi.totalCart(),a=cartApi.totalCount(),b=document.querySelectorAll(".total-count");b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())d.value.innerText=a;document.querySelector(".total-cart").innerText=g(c);b=document.querySelector(".order");0<a&&b.classList.contains("disabled")?
b.classList.remove("disabled"):0!=a||b.classList.contains("disabled")||b.classList.add("disabled");document.querySelector(".cart-string").setAttribute("value",c)}function e(c){var b="?";c=$jscomp.makeIterator(c.elements);for(var a=c.next();!a.done;a=c.next())a=a.value,a.name&&(b+=encodeURIComponent(a.name)+"="+encodeURIComponent(a.value)+"&");return b.slice(0,-1)}var b=document.querySelector("body"),a=document.querySelector("#nav"),f=document.querySelector('a[href="#nav"]'),l=document.querySelector("#nav .close"),
n=document.querySelector("#cart"),k=document.querySelectorAll('a[href="#cart"]'),m=document.querySelector("#cart .close");window.addEventListener("DOMContentLoaded",function(){b.classList.remove("is-loading");b.classList.remove("trans")});var q=function(){a.classList.remove("visible");b.classList.remove("menu-visible")},r=function(){n.classList.remove("visible");b.classList.remove("menu-visible")},w=function(){n.classList.toggle("visible");b.classList.toggle("menu-visible")};b.addEventListener("click",
function(c){b.classList.contains("menu-visible")&&(c.preventDefault(),c.stopPropagation(),q(),r())},!1);a.addEventListener("click",function(c){c.stopPropagation()},!1);n.addEventListener("click",function(c){c.stopPropagation()},!1);f.addEventListener("click",function(c){c.preventDefault();c.stopPropagation();a.classList.toggle("visible");b.classList.toggle("menu-visible")},!1);l.addEventListener("click",function(c){c.preventDefault();c.stopPropagation();q()},!1);f=$jscomp.makeIterator(k);for(l=f.next();!l.done;l=
f.next())l.value.addEventListener("click",function(c){c.preventDefault();c.stopPropagation();w()},!1);m.addEventListener("click",function(c){c.preventDefault();c.stopPropagation();r()},!1);var x=function(c){var a=this.getAttribute("href"),d=this.getAttribute("target");a&&-1==a.indexOf("#")&&-1==a.indexOf("tel")&&-1==a.indexOf("wa.me")&&-1==a.indexOf("mailto")&&"_blank"!=d&&(c.preventDefault(),c.stopPropagation(),q(),r(),b.classList.add("trans"),window.setTimeout(function(){window.location.href=a;
console.log("250")},250))};b.addEventListener("click",function(c){for(var a=c.target;a&&a!=this;a=a.parentNode)if(a.matches("a")){x.call(a,c);break}},!1);a.addEventListener("click",function(a){for(var c=a.target;c&&c!=this;c=c.parentNode)if(c.matches("a")){x.call(c,a);break}},!1);d();p();m=document.querySelector(".order");f=document.querySelectorAll(".return-to-cart");var t=document.querySelector(".cart-cart"),u=document.querySelector(".form-wrapper");m.addEventListener("click",function(a){a.preventDefault();
a.stopPropagation();this.classList.contains("disabled")||(t.classList.add("hide"),u.classList.remove("hide"),u.classList.add("fade-in"))});m=$jscomp.makeIterator(f);for(f=m.next();!f.done;f=m.next())f.value.addEventListener("click",function(a){a.preventDefault();a.stopPropagation();u.classList.add("hide");t.classList.remove("hide");t.classList.add("fade-in");a=this.parentNode;if(a.classList.contains("form-success")||a.classList.contains("form-error")){var c=document.querySelector(".ajax-form");a.classList.add("hide");
c.classList.remove("hide");c.classList.add("fade-in")}});(m=document.querySelector(".add-to-cart"))&&m.addEventListener("click",function(a){a.preventDefault();a.stopPropagation();a=document.getElementById("product");a=JSON.parse(a.textContent);0==cartApi.totalCount()&&w();cartApi.addNewItemToCart(a.id,a.title,a.price,a.url,1);d();p();this.innerHTML="\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e"},!1);n.addEventListener("click",function(a){for(var b=a.target;b&&b!=this;b=b.parentNode)if(b.matches(".minus-item, .plus-item")){a.preventDefault();
a.stopPropagation();var c=b.getAttribute("data");a=b.parentNode.querySelector("span");b.classList.contains("plus-item")?a.innerText=cartApi.addItemToCart(c):(c=cartApi.removeItemFromCart(c),0<c?a.innerText=c:(b=b.parentNode.parentNode.parentNode,b.parentNode.removeChild(b)));p();break}},!1);document.querySelector(".ajax-form").addEventListener("submit",function(a){a.preventDefault();a=e(this);var b=cartApi.cartToQuerry();a="https://europe-west2-toy-project-275819.cloudfunctions.net/nocors"+a+b;var c=
this.parentNode.querySelector(".form-loading"),f=this.parentNode.querySelector(".form-success"),g=this.parentNode.querySelector(".form-error");this.classList.add("hide");c.classList.remove("hide");c.classList.add("fade-in");b=new XMLHttpRequest;b.open("GET",a);b.onload=function(){200<=this.status&&400>this.status?(console.log("Success"),console.log(this.responseText),c.classList.add("hide"),f.classList.remove("hide"),f.classList.add("fade-in"),cartApi.clearCart(),d(),p()):(console.log("Server returned error"),
c.classList.add("hide"),g.classList.remove("hide"),g.classList.add("fade-in"))};b.onerror=function(){console.log("Connection error");c.classList.add("hide");g.classList.remove("hide");g.classList.add("fade-in")};b.send()},!1)})();